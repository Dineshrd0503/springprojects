<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Search Products</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
<div class="container mt-4">
    <h1>Search for Products</h1>
    <p>Fill in one or more fields to filter the product list. Leave fields blank to ignore them.</p>
    <hr/>

    <!-- UPDATE: Added an onsubmit event to call our validation function -->
    <form th:action="@{/products/results}" method="get" onsubmit="return validateSearchForm()">
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="id" class="form-label">Product ID</label>
                <input type="number" name="id" class="form-control" id="id" placeholder="e.g., 101">
            </div>
            <div class="col-md-6 mb-3">
                <label for="name" class="form-label">Product Name Contains</label>
                <input type="text" name="name" class="form-control" id="name" placeholder="e.g., Milk">
            </div>
        </div>
        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="category" class="form-label">Category Contains</label>
                <input type="text" name="category" class="form-control" id="category" placeholder="e.g., Dairy">
            </div>
            <div class="col-md-6 mb-3">
                <label for="quantity" class="form-label">Exact Quantity</label>
                <input type="number" name="quantity" class="form-control" id="quantity" placeholder="e.g., 100">
            </div>
        </div>

        <button type="submit" class="btn btn-primary">Search</button>
        <a th:href="@{/products}" class="btn btn-secondary">Back to Full List</a>
    </form>
</div>

<!-- UPDATE: Added JavaScript for client-side validation -->
<script>
    function validateSearchForm() {
        // Get all the input fields from the form
        const inputs = document.querySelectorAll('form input[name]');
        let isAtLeastOneFieldFilled = false;

        // Loop through the inputs to see if any have a value
        for (const input of inputs) {
            if (input.value.trim() !== '') {
                isAtLeastOneFieldFilled = true;
                break; // Found a filled field, no need to check further
            }
        }

        // If no fields are filled, show an alert and prevent the form from submitting
        if (!isAtLeastOneFieldFilled) {
            alert('Please fill in at least one field to perform a search.');
            return false; // This stops the form submission
        }

        // If at least one field is filled, allow the form to submit
        return true;
    }
</script>

</body>
</html>